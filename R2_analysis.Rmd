---
title: "R2 analysis"
author: "Abby Lewis"
date: "9/16/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
r2 = read.csv("R2 Analysis_prelim.csv")

r2%>%
  mutate(R2_value = as.numeric(R2_value))%>%
  mutate(Horiz_days = as.numeric(Horiz_days))%>%
  ggplot(aes(x = Horiz_days, y = R2_value))+
  geom_point()+
  xlim(0,10)

r2%>%
  mutate(R2_value = as.numeric(R2_value))%>%
  mutate(Horiz_days = as.numeric(Horiz_days))%>%
  ggplot(aes(x = Class, y = R2_value))+
  geom_boxplot()

r2%>%
  mutate(R2_value = as.numeric(R2_value))%>%
  ggplot(aes(x = , y = R2_value))+
  geom_boxplot()

```

```{r}
all <- read.csv("complete_dataset.csv")
all$R2 <- as.numeric(grepl("[R,r]2",all$Eval_metrics))

using_r2 = all%>%
  filter(R2 == 1)
r2_found <- read.csv("R2 analysis_04Nov20.csv")%>%
  select(Title, R2_value, Notes)
r2_second_attempt <- left_join(using_r2, r2_found)%>%
  arrange(is.na(R2_value))
#write.csv(r2_second_attempt, "r2_second_attempt.csv", row.names = F)
r2s <- read.csv("r2_second_attempt.csv")
r2s%>%
  group_by_at(setdiff(names(r2s), c("Site_or_year_group","R2_value")))%>%
  summarize(R2_value = mean(as.numeric(R2_value)))
```

